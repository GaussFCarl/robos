#!/usr/bin/env python# -*- coding: utf-8 -*-import urllibfrom helper import *#connectTor()#newidentity()def parser(data,linha):    str_sql = "INSERT INTO emprestimosreg  (data,ticker,nome,n_contratos,qtd_shs,volume,doador_min,doador_med,doador_max,tomador_min,tomador_med,tomador_max) values (%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"    cursor.execute(str_sql, tuple([data]+linha.strip('\r\n').decode('iso-8859-1').split('|')[1:]))    conn.commit()conn ,cursor,engine = conection("dados")lista = contexto(cursor,"emprestimosreg")btc = urllib.urlopen('ftp://ftp.bmf.com.br/ipnv2/SVI/DBTCER/SI_D_DBTCER.txt')linhas= btc.readlines()try:    aux = linhas[0].split('|')    data = aux[1][:4] + '-' + aux[1][4:6] + '-' + aux[1][6:8]    if data not in lista:        for linha in linhas[1:]:            parser(data,linha)        with open(r"C:\Users\luiz\PycharmProjects\robos\checklist.txt", 'a') as checklist:            checklist.writelines('emprestimosreg\n')except:    error('algum erro do processo em geral')